<div data-controller="form--multi-select" class="mt-3 relative w-full <%= @classes %>">
  <div class="cursor-pointer w-full border rounded-md border-gray-200 py-2.5 pe-10 shadow-sm sm:text-sm" data-action="click->form--multi-select#toggleDropdown">
    <div data-form--multi-select-target="input" class="selected-items flex flex-wrap lg:p-2">
        <span data-form--multi-select-target="placeholder" class="placeholder w-full flex justify-between items-center text-gray-300 lg:text-sm <%= 'hidden' if @placeholder.blank? %>">
          <div class='flex flex-col justify-center text-gray-400 hover:text-gray-500'><%= @placeholder %></div>

          <div>
          <%= heroicon 'plus-circle', variant: 'outline', options: { class: 'w-5 text-gray-500' } %>
          </div>
        </span>

    </div>

  </div>
  <div class="dropdown absolute left-0 mt-1 w-full bg-white shadow-md border border-gray-300 rounded-md hidden z-[100]" data-form--multi-select-target="dropdown">
    <% @collection.each do |item| %>
      <div data-form--multi-select-target="options" data-value="<%= item %>" data-action="click->form--multi-select#selectOption" class="option">
        <%= item %>
      </div>
    <% end %>
  </div>
<template data-form--multi-select-target="tagTemplate">
  <div class="tag-wrapper inline-block">
    <span class="bg-blue-500 text-white rounded px-2 py-1 text-sm mr-2 mb-2 relative">
      <span data-remove-btn="true" class="text-red-600 text-xl cursor-pointer absolute top-0 right-0 mr-1 mt-[-4px] z-50" data-action="click->form--multi-select#removeOption">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" class="remove-btn" style="background: rgba(255, 255, 255, 0.75); border-radius: 50%; padding: 2px; box-shadow: 0px 0px 2px rgba(0, 0, 0, 0.25);">
          <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 01.708 0L8 7.293l2.646-2.647a.5.5 0 11.708.708L8.707 8l2.647 2.646a.5.5 0 01-.708.708L8 8.707l-2.646 2.647a.5.5 0 11-.708-.708L7.293 8 4.646 5.354a.5.5 0 010-.708z" clip-rule="evenodd"/>
        </svg>
      </span>
    </span>
  </div>
</template>

  
  <input type="hidden" data-form--multi-select-target="selected" name="<%= @attribute %>" />

</div>

<style>

.tag-wrapper {
  display: inline-flex;
  flex-shrink: 0;
  flex-grow: 0;
}

.selected-items {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  min-width: 0;
  flex-grow: 1;
  align-items: start;
}


.form--multi_select {
  max-height: 100%;
  overflow-y: auto;
}

.input-container {
  /* padding: 10px 12px; */
  cursor: pointer;
}

.selected-items {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  min-width: 0;
  flex-grow: 1;
}

.selected-item {
  background-color: #0076ff;
  color: #fff;
  padding: 2px 4px;
  border-radius: 4px;
}

.dropdown {
  position: absolute;
  width: 100%;
  background-color: #fff;
  border: 1px solid #ccc;
  padding: 4px 8px;
  z-index: 100;
  max-height: 200px;
  overflow-y: auto;
}

.option {
  cursor: pointer;
  padding: 4px;
}

.option:hover {
  background-color: #f3f3f3;
}
</style>